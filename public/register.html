<!DOCTYPE html>
<html>
<head>
    <title>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h1>
            <p>–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞</p>
        </div>
        
        <div class="content">
            <div id="message" class="message error" style="display: none;"></div>
            
            <form id="registerForm">
                <div class="form-group">
                    <input type="text" id="username" placeholder="–õ–æ–≥–∏–Ω" required>
                </div>
                
                <div class="form-group password-wrapper">
        <input type="password" id="password" 
            placeholder="–ü–∞—Ä–æ–ª—å" required 
            minlength="8"
            pattern="^(?=.*[0-9!@#$%^&*]).{8,}$"
            title="–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –º–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤ –∏ —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ü–∏—Ñ—Ä—ã –∏–ª–∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã !@#$%^&*">
        <button type="button" class="toggle-password" id="togglePassword" title="–ü–æ–∫–∞–∑–∞—Ç—å –ø–∞—Ä–æ–ª—å">üëÅÔ∏è</button>
</div>
                
                <button type="submit" class="btn">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
            </form>
            
            <div class="links">
                <p>–£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç? <a href="login.html">–í–æ–π—Ç–∏</a></p>
                <p><a href="index.html">‚Üê –ù–∞ –≥–ª–∞–≤–Ω—É—é</a></p>
            </div>
        </div>
    </div>
    
    <script>
        document.getElementById('registerForm').addEventListener('submit', async (e) => {
            e.preventDefault(); // –æ—Ç–º–µ–Ω—è–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä–Ω—É—é –æ—Ç–ø—Ä–∞–≤–∫—É —Ñ–æ—Ä–º—ã(–ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã)
            // –ë–µ–∑ —ç—Ç–æ–≥–æ —É –Ω–∞—Å –±—ã —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏–ª–∞—Å—å –∏ –Ω–∞—à JavaScript –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª 
            
            // –ü–æ–ª—É—á–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ–ª–µ–π —Ñ–æ—Ä–º—ã
            const username = document.getElementById('username').value; // –ü–æ–ª—É—á–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ –ø–æ–ª—è –≤–≤–æ–¥–∞ —Å id="userbame"
            const password = document.getElementById('password').value; //
            const message = document.getElementById('message'); // message —Å—Å—ã–ª–∫–∞ –Ω–∞ —ç–ª–µ–º–µ–Ω—Ç –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π (–æ–±—ã—á–Ω–æ div spam)
            
            // –°–∫—Ä—ã–≤–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
            message.style.display = 'none'; // –°–±—Ä–∞—Å—ã–≤–∞–µ—Ç –ø—Ä–µ–≤—ã–¥—É—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–∞—Ö/—É—Å–ø–µ—Ö–µ –ø–µ—Ä–µ–¥ –Ω–æ–≤–æ–π –ø–æ–ø—ã—Ç–∫–æ–π 

            // –ù–∞—á–∏–Ω–∞–µ–º  –±–ª–æ–∫ try-cath –¥–ª—è –æ–±—Ä–æ–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫
            try {                                   // –Ω–∞—á–∞–ª–∞ –±–ª–æ–∫–∞ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–¥–∞, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å –æ—à–∏–±–∫—É 
                const response = await fetch('/auth/register', {  // –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–Ω—ã–π HTTP-–∑–∞–ø—Ä–æ—Å  await –∂–¥–µ—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ (—Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤ asinc —Ñ—É–Ω–∫—Ü–∏—è—Ö)
                    method: 'POST', // —É–∫–∞–∑—ã–≤–∞–µ—Ç –º–µ—Ç–æ–¥ HTTP –∑–∞–ø–∞—Ä–æ—Å–∞ (–∑–∞–º–µ–Ω–∞ XMLHttpRequest)
                    headers: {
                        'Content-Type': 'application/json', // —É–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–∏–ø –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö 
                    },
                    body: JSON.stringify({ username, password }) // –ø—Ä–∏–æ–±—Ä–∞–∑—É–µ—Ç –æ–±—å–µ–∫—Ç –≤ JSON —Å—Ç—Ä–æ–∫—É
                });
                
                // –û–ë—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —É—Å–ø–µ—à–Ω—ã–π –ø—Ä–æ–µ–∫—Ç 
                if (response.ok) {  // –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç true –µ—Å–ª–∏ HTTP —Å—Ç–∞—Ç—É—Å 200-299(—É—Å–ø–µ—Ö)
                    const data = await response.json();
                    localStorage.setItem('token', data.access_token);
                    
                    // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
                    window.location.href = 'index.html';
                } else {
                    const error = await response.json();
                    message.textContent = '–û—à–∏–±–∫–∞: ' + error.message;
                    message.style.display = 'block';
                }
            } catch (error) {
                message.textContent = '–û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ' + error.message;
                message.style.display = 'block';
            }
        });
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', function() {
            const token = localStorage.getItem('token');
            if (token) {
                window.location.href = 'index.html';
            }
        });

        //toggle password visibility(–ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∏–¥–∏–º–æ—Å—Ç–∏ –ø–∞—Ä–æ–ª—è)
        document.addEventListener('DOMContentLoaded', function() {
            const passwordInput = document.getElementById('password'); 
            const toggleButton = document.getElementById('togglePassword'); 

            toggleButton.addEventListener('click', function(){
                if (passwordInput.type === 'password') {
                    passwordInput.type = 'text'; 
                    this.textContent = 'üëÅÔ∏è‚Äçüó®Ô∏è'; 
                    this.title = '–°–∫—Ä—ã—Ç—å –ø–∞—Ä–æ–ª—å'; 
                } else {
                    passwordInput.type = 'password'; 
                    this.textContent = 'üëÅÔ∏è', 
                    this.title = '–ü–æ–∫–∞–∑–∞—Ç—å –ø–∞—Ä–æ–ª—å'; 
                }
                passwordInput.focus(); 
            })
        })
    </script>
</body>
</html>